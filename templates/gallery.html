<!DOCTYPE html>
<html lang="en">
<head>
    <title>Gallery - local-booru</title>
</head>
<body>
    {% include '_header.html' %}

    <form class="search-form" action="/gallery" method="get" autocomplete="off">
        <div class="autocomplete-container">
            <input
                type="text"
                id="tagInput"
                name="q"
                value="{{ query }}"
                placeholder="Search tags..."
                autocomplete="off"
            />
            <div class="suggestions"></div>
        </div>
        <button type="submit">Search</button>
    </form>

    <div id="thumbnail-controls">
        <button data-size="250">Small</button>
        <button data-size="400">Medium</button>
        <button data-size="600">Large</button>
    </div>

    <!-- Top pagination container for easier navigation -->
    <div id="pagination-top" class="pagination"></div>

    <div id="gallery-grid" class="gallery"></div>
    
    <!-- Bottom pagination container -->
    <div id="pagination-bottom" class="pagination"></div>

    <div id="lightbox-modal">
        <span id="lightbox-close">×</span>
        <div id="lightbox-content" class="view-mode">
            
            <!-- A SINGLE, CORRECT container for the image, nav, and overlay -->
            <div id="lightbox-image-container">
                 <img id="lightbox-image" src="" alt="Lightbox image">
                 <div class="lightbox-nav">
                    <button id="lightbox-prev" title="Previous (A)">❮</button>
                    <button id="lightbox-next" title="Next (D)">❯</button>
                </div>
                <!-- The view-mode content is now an overlay INSIDE the image container -->
                <div id="lightbox-view-mode-content">
                    <h4 id="lightbox-image-id"></h4>
                    <div class="tag-pills-container"></div>
                    <div class="lightbox-actions">
                         <button id="lightbox-edit-btn" class="action-button" title="Edit (E)">Edit Tags</button>
                         <button id="lightbox-delete-btn" class="action-button danger" title="Delete (Shift+D)">Delete</button>
                    </div>
                </div>
            </div>
           
            <!-- Sidebar is now ONLY for editing -->
            <div id="lightbox-sidebar">
                <div id="lightbox-edit-mode-content">
                    <!-- This container now uses the shared style -->
                    <div id="lightbox-tag-editor-container" class="tag-panel-container">
                        <h5 class="tag-panel-title">Current Tags</h5>
                        <div class="tag-panel-content">
                            <div id="lightbox-tag-editor-pills"></div>
                            <div class="autocomplete-container">
                                 <input type="text" id="lightbox-tag-input" placeholder="Add or search for a tag..." autocomplete="off">
                            </div>
                        </div>
                    </div>

                    <!-- The helper also uses the shared style for consistency -->
                    <div id="lightbox-tag-helper" class="tag-panel-container">
                        <h5 id="tag-helper-title" class="tag-panel-title">Recent Tags</h5>
                        <div id="tag-helper-content-area" class="tag-panel-content">
                            <!-- Dynamic content (recents or search results) is rendered here -->
                        </div>
                    </div>

                    <div class="lightbox-actions">
                        <button id="lightbox-save-btn" class="action-button" title="Save (S)">Save</button>
                        <button id="lightbox-cancel-btn" class="action-button" title="Cancel (Esc)">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
        <p id="lightbox-loading-indicator" style="display: none;">Loading...</p>
    </div>

    <div id="tag-tooltip" class="thumb-tooltip"></div>

	<script src="/static/js/ui_helpers.js"></script>
	<script src="/static/js/saved_searches_manager.js"></script>
	<script src="/static/js/autocomplete.js"></script>
	<script src="/static/js/notifications.js"></script>
    <script src="/static/js/shared_gallery.js"></script>
    <script src="/static/js/gallery.js"></script>
</body>
</html>